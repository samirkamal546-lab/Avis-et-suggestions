<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EsiCareerBridge - Avis & Questionnaire</title>
  <style>
    :root{
      --primary:#2c3e50; --secondary:#3498db; --accent:#e74c3c;
      --light:#f6f8fa; --card:#ffffff;
    }
    body{font-family:Inter,Segoe UI,Arial,sans-serif;margin:0;background:linear-gradient(#f7fafc,#eef2f7);}
    header{display:flex;align-items:center;justify-content:space-between;padding:14px 28px;background:#fff;box-shadow:0 2px 6px rgba(0,0,0,0.06);}
    .logo-row{display:flex;gap:12px;align-items:center;}
    .logo-row img{width:48px;height:48px;object-fit:cover;border-radius:8px;}
    nav a{margin:0 12px;color:var(--primary);text-decoration:none;font-weight:600}
    .btn{background:var(--accent);color:#fff;padding:10px 16px;border-radius:8px;border:0;cursor:pointer}
    .container{max-width:1100px;margin:28px auto;padding:0 20px;}
    .hero{background:linear-gradient(90deg,#1e3c72,#2a72b8);color:#fff;padding:60px;border-radius:12px;text-align:center;box-shadow:0 8px 30px rgba(16,24,40,0.08);}
    .hero h1{font-size:36px;margin:0 0 12px}
    .grid{display:grid;grid-template-columns:1fr 420px;gap:24px;margin-top:24px;align-items:start}
    .card{background:var(--card);padding:18px;border-radius:10px;box-shadow:0 6px 18px rgba(15,23,42,0.06);}
    /* Tabs */
    .tabs{display:flex;gap:10px;margin-bottom:12px}
    .tab-btn{padding:8px 12px;border-radius:8px;border:1px solid #e6e9ee;background:#fff;cursor:pointer}
    .tab-btn.active{background:var(--secondary);color:#fff;border-color:transparent}
    /* Form */
    form .row{display:flex;gap:12px;margin-bottom:12px}
    label{display:block;font-weight:600;margin-bottom:6px;color:var(--primary)}
    input[type=text], input[type=email], select, textarea{
      width:100%;padding:10px;border-radius:8px;border:1px solid #e6e9ee;background:#fff;
      box-sizing:border-box;font-size:14px;
    }
    textarea{min-height:100px;resize:vertical}
    .actions{display:flex;gap:10px;justify-content:flex-end;margin-top:12px}
    .success{background:#ecfdf5;border:1px solid #bbf7d0;padding:12px;border-radius:8px;color:#065f46;display:flex;gap:12px;align-items:center}
    .list{list-style:none;padding:0;margin:0}
    .company{padding:12px;border-radius:8px;border:1px solid #eef2f6;margin-bottom:10px;background:#fff}
    .small{font-size:13px;color:#475569}
    footer{padding:20px;text-align:center;color:#6b7280;font-size:13px;margin-top:26px}
    /* responsive */
    @media (max-width:960px){
      .grid{grid-template-columns:1fr; }
    }
  </style>
</head>
<body>

<header>
  <div class="logo-row">
    <!-- Place logo file next to HTML or replace src with data URI -->
    <img src="Logo-fotor-20251114173024.png" alt="Logo (place image in same folder)">
    <div>
      <div style="font-weight:800;color:var(--primary);font-size:18px">Esi<span style="color:var(--accent)">CareerBridge</span></div>
      <div class="small">Plateforme intelligente de stages</div>
    </div>
  </div>
  <nav>
    <a href="#accueil">Accueil</a>
    <a href="#fonctionnalites">Fonctionnalit√©s</a>
    <a href="#avis">Avis</a>
    <button class="btn" onclick="scrollToSection('#avis')">Se connecter</button>
  </nav>
</header>

<div class="container">
  <section class="hero" id="accueil">
    <h1>Votre Pont vers l'Excellence Professionnelle</h1>
    <p style="max-width:820px;margin:10px auto 0">Notre plateforme transforme votre recherche de stage en parcours de d√©veloppement complet, int√©grant les soft skills directement dans votre pr√©paration.</p>
  </section>

  <div class="grid">
    <div>
      <!-- Main content -->
      <div class="card" id="features">
        <h2 style="margin-top:0">Pourquoi EsiCareerBridge</h2>
        <p class="small">Matching intelligent, parcours de d√©veloppement et analytics pour suivre votre progression.</p>
      </div>

      <!-- Avis & Suggestion + Questionnaire area -->
      <div class="card" id="avis" style="margin-top:18px">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <h2 style="margin:0">Avis et suggestions</h2>
          <div>
            <button class="tab-btn" id="tab-questionnaire">Questionnaire</button>
            <button class="tab-btn" id="tab-suggestions">Suggestions</button>
            <button class="tab-btn" id="tab-admin">Admin</button>
          </div>
        </div>

        <div id="views" style="margin-top:14px">
          <!-- Questionnaire View -->
          <div id="view-questionnaire" style="display:none">
            <div class="small" style="margin-bottom:12px">
              Aidez les futurs stagiaires en partageant votre exp√©rience.
            </div>
            <div id="success-banner" style="display:none" class="success">
              <strong>Merci ‚Äî</strong> votre contribution a √©t√© enregistr√©e.
            </div>
            <form id="questionnaire-form">
              <div class="row">
                <div style="flex:1">
                  <label for="name">Nom</label>
                  <input id="name" type="text" placeholder="Ton nom (ex: Hamza)">
                </div>
                <div style="flex:1">
                  <label for="email">E-mail</label>
                  <input id="email" type="email" placeholder="exemple@mail.com">
                </div>
              </div>

              <div class="row">
                <div style="flex:1">
                  <label for="field">Fili√®re</label>
                  <select id="field">
                    <option value="Data Science">Data Science</option>
                    <option value="Cybers√©curit√©">Cybers√©curit√©</option>
                    <option value="R√©seaux">R√©seaux</option>
                    <option value="Autre">Autre</option>
                  </select>
                </div>
                <div style="flex:1">
                  <label for="company">Entreprise (o√π tu as fait le stage)</label>
                  <input id="company" type="text" placeholder="Nom de l'entreprise (ex: Oracle)">
                </div>
              </div>

              <div>
                <label for="rating">Note du stage (1 √† 5)</label>
                <select id="rating">
                  <option>5</option><option>4</option><option>3</option><option>2</option><option>1</option>
                </select>
              </div>

              <div style="margin-top:12px">
                <label for="location">Ville</label>
                <input id="location" type="text" placeholder="Ex: Casablanca, Rabat, Tunis...">
              </div>

              <div style="margin-top:12px">
                <label for="comments">Commentaires / Suggestions</label>
                <textarea id="comments" placeholder="Racontez votre exp√©rience, conseils pour d'autres stagiaires..."></textarea>
              </div>

              <div class="actions">
                <button type="button" class="tab-btn" onclick="clearForm()">Effacer</button>
                <button type="submit" class="btn">Envoyer</button>
              </div>
            </form>
          </div>

          <!-- Suggestions View -->
          <div id="view-suggestions" style="display:none">
            <div class="small" style="margin-bottom:12px">
              Entrez votre ville pour voir des suggestions d'entreprises pr√®s de chez vous.
            </div>
            <div style="display:flex;gap:10px;margin-bottom:12px">
              <input id="suggestion-city" type="text" placeholder="Ex: Casablanca" style="flex:1;padding:10px;border-radius:8px;border:1px solid #e6e9ee">
              <button class="btn" id="btn-find">Voir les suggestions</button>
            </div>
            <div id="suggestions-list"></div>

            <hr style="margin:14px 0">

            <h3 style="margin:8px 0">Liste g√©n√©rale d'entreprises recommand√©es</h3>
            <div id="general-companies">
              <!-- static list from your content -->
              <div class="company">
                <strong>ONCF</strong><div class="small">Stages: Data Science, Cybers√©curit√©, Logistique</div>
                <p class="small">T√©moignage: "Je suis ravi de rejoindre l'ONCF..." ‚Äî HAMZA</p>
              </div>
              <div class="company">
                <strong>Inwi & Orange</strong><div class="small">Stages: R√©seaux, Cybers√©curit√©</div>
              </div>
              <div class="company">
                <strong>Oracle (Casablanca)</strong><div class="small">Stages: IA, Cloud, Data Science</div>
              </div>
              <div class="company">
                <strong>3T D√©veloppement Maroc</strong><div class="small">Stages: Data Science, Marketing, Retail</div>
              </div>
              <div class="company">
                <strong>Lotus Capital Gestion</strong><div class="small">Stages: Trading quantitatif, fintech, data</div>
              </div>
              <div class="company">
                <strong>Sofrecom</strong><div class="small">Stages: Data science, Radio, IA, DEV</div>
              </div>
              <div class="company">
                <strong>Stagiaires.ma</strong><div class="small">Plateforme de recherche de stages</div>
              </div>
            </div>
          </div>

          <!-- Admin View -->
          <div id="view-admin" style="display:none">
            <h3 style="margin-top:0">Administration ‚Äî r√©ponses enregistr√©es</h3>
            <div id="admin-list">
              <p class="small">Aucune donn√©e pour le moment.</p>
            </div>
            <div style="margin-top:12px">
              <button class="tab-btn" id="export-json">Exporter JSON</button>
              <button class="tab-btn" id="clear-all">Supprimer toutes les r√©ponses</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right column: quick tips or images -->
    <aside>
      <div class="card">
        <h3>Conseils rapides</h3>
        <ul class="list small">
          <li>üîç Sois pr√©cis dans ta description du stage</li>
          <li>üì∏ Ajoute un portfolio si possible</li>
          <li>üß≠ Indique la ville pour des suggestions locales</li>
        </ul>
      </div>

      <div class="card" style="margin-top:14px">
        <h3>Image</h3>
        <img src="media/image1.png" alt="illustration" style="width:100%;border-radius:8px;display:block">
      </div>
    </aside>
  </div>

  <footer>
    &copy; 2025 EsiCareerBridge ‚Äî Plateforme collaborative pour aider les √©tudiants
  </footer>
</div>

<script>
  // ----- Simple client-side data store (localStorage) -----
  const STORAGE_KEY = "ecb_submissions_v1";

  function loadSubmissions(){
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      return raw ? JSON.parse(raw) : [];
    } catch(e){
      console.error(e);
      return [];
    }
  }
  function saveSubmissions(arr){
    localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
  }

  // ----- UI helpers -----
  const TABS = {
    questionnaire: document.getElementById('tab-questionnaire'),
    suggestions: document.getElementById('tab-suggestions'),
    admin: document.getElementById('tab-admin')
  };
  const VIEWS = {
    questionnaire: document.getElementById('view-questionnaire'),
    suggestions: document.getElementById('view-suggestions'),
    admin: document.getElementById('view-admin')
  };

  function setActiveTab(name){
    // style tabs
    Object.keys(TABS).forEach(k => {
      TABS[k].classList.toggle('active', k===name);
      VIEWS[k].style.display = (k===name ? 'block' : 'none');
    });
    // hide success banner when switching
    document.getElementById('success-banner').style.display = 'none';
  }

  // initialize default view
  TABS.questionnaire.addEventListener('click', () => setActiveTab('questionnaire'));
  TABS.suggestions.addEventListener('click', () => setActiveTab('suggestions'));
  TABS.admin.addEventListener('click', () => setActiveTab('admin'));
  setActiveTab('questionnaire');

  // ----- Form submit logic -----
  const form = document.getElementById('questionnaire-form');
  const successBanner = document.getElementById('success-banner');

  form.addEventListener('submit', function(ev){
    ev.preventDefault();
    const data = {
      id: Date.now(),
      name: document.getElementById('name').value.trim(),
      email: document.getElementById('email').value.trim(),
      field: document.getElementById('field').value,
      company: document.getElementById('company').value.trim(),
      rating: document.getElementById('rating').value,
      location: document.getElementById('location').value.trim(),
      comments: document.getElementById('comments').value.trim()
    };

    // basic validation
    if(!data.name || !data.email){
      alert("Merci d'indiquer au moins votre nom et e-mail.");
      return;
    }

    const submissions = loadSubmissions();
    submissions.unshift(data); // latest first
    saveSubmissions(submissions);

    // Show success, clear form, go to suggestions after 1.8s
    successBanner.style.display = 'flex';
    form.reset();
    setTimeout(() => {
      successBanner.style.display = 'none';
      setActiveTab('suggestions');
      // prefill suggestions input with submitted location if present
      if(data.location){
        document.getElementById('suggestion-city').value = data.location;
        document.getElementById('btn-find').click();
      }
      renderAdmin();
    }, 1800);
  });

  function clearForm(){
    if(confirm("Effacer le formulaire ?")) form.reset();
  }

  // ----- Suggestions logic -----
  const btnFind = document.getElementById('btn-find');
  const suggestionsList = document.getElementById('suggestions-list');

  // static mapping of some sample companies by city keywords
  const COMPANY_DB = [
    {name:"ONCF", cities:["Rabat","Casablanca","Tanger","Fes"], tags:["Data Science","Cybers√©curit√©"]},
    {name:"Oracle Maroc (Casablanca)", cities:["Casablanca"], tags:["Cloud","Data Science","IA"]},
    {name:"Inwi", cities:["Casablanca","Rabat","Tunis"], tags:["R√©seaux","Cybers√©curit√©"]},
    {name:"Orange", cities:["Casablanca","Rabat"], tags:["R√©seaux","Telecom"]},
    {name:"Sofrecom", cities:["Casablanca","Rabat"], tags:["Data Science","IA"]},
    {name:"3T D√©veloppement", cities:["Casablanca","Rabat"], tags:["Data Science","Retail"]},
    {name:"Lotus Capital Gestion", cities:["Casablanca"], tags:["Finance","Data Science"]},
    {name:"Stagiaires.ma", cities:[], tags:["Plateforme"]},
  ];

  function findCompaniesByCity(city){
    if(!city) return COMPANY_DB;
    const query = city.trim().toLowerCase();
    // first prioritize exact city matches
    const exact = COMPANY_DB.filter(c => c.cities.some(ct => ct.toLowerCase().includes(query)));
    const fallback = COMPANY_DB.filter(c => !exact.includes(c));
    return exact.concat(fallback);
  }

  btnFind.addEventListener('click', function(){
    const city = document.getElementById('suggestion-city').value.trim();
    const results = findCompaniesByCity(city);
    suggestionsList.innerHTML = "";
    if(results.length === 0){
      suggestionsList.innerHTML = "<p class='small'>Aucune suggestion trouv√©e pour cette ville.</p>";
      return;
    }
    results.forEach(r => {
      const div = document.createElement('div');
      div.className = 'company';
      div.innerHTML = `<strong>${r.name}</strong><div class="small">Sp√©cialit√©s: ${r.tags.join(", ") || "Divers"}</div>`;
      suggestionsList.appendChild(div);
    });
    // scroll to results
    suggestionsList.scrollIntoView({behavior:'smooth'});
  });

  // ----- Admin area -----
  const adminList = document.getElementById('admin-list');
  function renderAdmin(){
    const subs = loadSubmissions();
    if(subs.length === 0){
      adminList.innerHTML = "<p class='small'>Aucune r√©ponse enregistr√©e.</p>";
      return;
    }
    const html = subs.map(s => {
      return `<div style="border:1px solid #eef2f6;padding:10px;border-radius:8px;margin-bottom:10px;background:#fff">
        <div style="display:flex;justify-content:space-between;gap:12px;align-items:center">
          <div>
            <strong>${escapeHtml(s.name)}</strong> <span class="small">| ${escapeHtml(s.field)} | note: ${escapeHtml(s.rating)}</span>
            <div class="small">${escapeHtml(s.company)} ‚Ä¢ ${escapeHtml(s.location)}</div>
          </div>
          <div style="display:flex;flex-direction:column;gap:8px">
            <button data-id="${s.id}" class="tab-btn btn-delete">Supprimer</button>
          </div>
        </div>
        <div style="margin-top:8px" class="small">${escapeHtml(s.comments)}</div>
      </div>`;
    }).join("");
    adminList.innerHTML = html;

    // attach delete listeners
    document.querySelectorAll('.btn-delete').forEach(b => {
      b.addEventListener('click', (e) => {
        const id = Number(e.currentTarget.getAttribute('data-id'));
        if(!confirm("Supprimer cette r√©ponse ?")) return;
        const filtered = loadSubmissions().filter(x => x.id !== id);
        saveSubmissions(filtered);
        renderAdmin();
      });
    });
  }

  document.getElementById('export-json').addEventListener('click', () => {
    const data = loadSubmissions();
    const blob = new Blob([JSON.stringify(data, null, 2)], {type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'submissions_ecb.json'; a.click();
    URL.revokeObjectURL(url);
  });

  document.getElementById('clear-all').addEventListener('click', () => {
    if(!confirm("Supprimer toutes les r√©ponses ?")) return;
    localStorage.removeItem(STORAGE_KEY);
    renderAdmin();
  });

  function escapeHtml(text){
    if(!text) return '';
    return text.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
  }

  // initialize admin on load
  renderAdmin();

  // simple helper to scroll
  function scrollToSection(sel){
    const node = document.querySelector(sel);
    if(node) node.scrollIntoView({behavior:'smooth'});
  }

  // expose scroll function to global (used by header button)
  window.scrollToSection = scrollToSection;
</script>

</body>
</html>
